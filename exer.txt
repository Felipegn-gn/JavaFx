1. Apresente o nome dos clientes que iniciam com a letra J
SELECT nome_cli FROM cliente WHERE nome_cli LIKE 'J%';

2. Quantos são os autores cadastrados no sistema
SELECT COUNT(*) AS total_autores FROM autor;


3. Apresente quantos livros o autor "Roberto Martins Figueiredo" escreveu
SELECT COUNT(*) AS livros_rob 
FROM escreve e
JOIN autor a ON e.id_autor = a.id_autor
WHERE a.nome_autor = 'Roberto Martins Figueiredo';

 

4. Apresente o título do livro e seu gênero ordenados por gênero e título.
SELECT l.titulo_liv, g.nome_gen AS genero
FROM livro l 
JOIN genero g ON l.id_genero = g.id_genero 
ORDER BY g.nome_gen, l.titulo_liv;

5. Apresente o nome do autor e a quantidade de livros que ele escreveu.
SELECT a.nome_autor, COUNT(e.id_livro) AS quantidade_livros
FROM autor a
JOIN escreve e ON a.id_autor = e.id_autor
GROUP BY a.nome_autor;


6. Apresente o nome dos autores que escreveram mais de um livro
SELECT a.nome_autor, COUNT(e.id_livro) AS quantidade_livros
FROM autor a
JOIN escreve e ON a.id_autor = e.id_autor
GROUP BY a.nome_autor
HAVING COUNT(e.id_livro) > 1;


7. Apresente o nome do livro e o nome do seu autor
SELECT l.titulo_liv, a.nome_autor
FROM livro l
JOIN escreve e ON l.id_livro = e.id_livro
JOIN autor a ON e.id_autor = a.id_autor;


8. Apresente o nome de cada cliente e o valor total de suas compras ordenando pelo valor das compras de forma decrescente
SELECT c.nome_cli, SUM(v.total_venda) AS total_compras 
FROM cliente c J
OIN venda v ON c.id_cliente = v.id_cliente 
GROUP BY c.nome_cli ORDER BY total_compras DESC;


9. Apresente os clientes que compraram o livro "Pelas Ruas de Calcutá", utilizando "like"
SELECT DISTINCT c.nome_cli
FROM cliente c
JOIN venda v ON c.id_cliente = v.id_cliente
JOIN itens_da_venda iv ON v.id_venda = iv.id_venda
JOIN livro l ON iv.id_livro = l.id_livro
WHERE l.titulo_liv LIKE '%Pelas Ruas de Calcutá%';



10. Apresente quantos exemplares existem em estoque dos livros da autora "Maria Jose Valero" , utilizando "like"
SELECT SUM(l.estoque_liv) AS total_estoque
FROM livro l
JOIN escreve e ON l.id_livro = e.id_livro
JOIN autor a ON e.id_autor = a.id_autor
WHERE a.nome_autor LIKE '%Maria Jose Valero%';


11. Apresente o nome do autor e a quantidade de livros dele que já foram vendidos ordenandos do maior para menor

SELECT a.nome_autor, SUM(iv.quantidade) AS total_vendidos
FROM autor a
JOIN escreve e ON a.id_autor = e.id_autor
JOIN itens_da_venda iv ON e.id_livro = iv.id_livro
GROUP BY a.nome_autor
ORDER BY total_vendidos DESC;


12. Qual a quantidade total de livros vendidos
SELECT SUM(quantidade) AS total_vendidos
FROM itens_da_venda;

13. Quais são os livros de "medicina"
SELECT l.titulo_liv
FROM livro l
JOIN genero g ON l.id_genero = g.id_genero
WHERE g.nome_genero LIKE '%Medicina%';

14. Apresente a quantidade em estoque do livro O Que Esperar Quando Você Esta Esperando usando like
SELECT l.estoque_liv
FROM livro l
WHERE l.titulo_liv LIKE '%O Que Esperar Quando Voce Esta Esperando%';

15. Qual é o valor do livro mais caro;
SELECT MAX(preco_liv) AS preco_mais_caro
FROM livro;

16. Apresente os livros que apresentam valor em estoque maior que 10
SELECT titulo_liv, estoque_liv
FROM livro
WHERE estoque_liv > 10;

17. Qual o valor total das vendas
SELECT SUM(total_venda) AS total_vendas
FROM venda;


18. Quantos gêneros tem cadastrados no banco?
SELECT COUNT(*) AS total_generos
FROM genero;

19. Apresente os gêneros que não possuem nenhum livro neste BD
SELECT g.nome_gen
FROM genero g
LEFT JOIN livro l ON g.id_genero = l.id_genero
WHERE l.id_livro IS NULL;

20. Selecione a média de preço dos livros.
SELECT AVG(preco_liv) AS media_preco
FROM livro;

21. Quais livros tem o preço acima da média
SELECT titulo_liv, preco_liv
FROM livro
WHERE preco_liv > (SELECT AVG(preco_liv) FROM livro);

22. Qual o nome do livro mais barato
SELECT titulo_liv, preco_liv
FROM livro
ORDER BY preco_liv ASC
LIMIT 1;

23. Selecionar os autores que escreveram somente um livro
SELECT a.nome_autor
FROM autor a
JOIN escreve e ON a.id_autor = e.id_autor
GROUP BY a.nome_autor
HAVING COUNT(e.id_livro) = 1;

24. Quem são os autores do livro ‘Metodologias Ativas Na Pratica Pedagogica’?
SELECT a.nome_autor
FROM autor a
JOIN escreve e ON a.id_autor = e.id_autor
JOIN livro l ON e.id_livro = l.id_livro
WHERE l.titulo_liv = 'Metodologias Ativas Na Pratica Pedagogica';


25. Quem são os autores do livro ‘Metodologias Ativas Na Pratica Pedagogica’?
